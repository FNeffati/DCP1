---
title: "Statistical Analysis of Author Popularity"
author: "Joshua D. Ingram"
date: "2023-04-11"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(tidyverse)

frequency <- read_csv("/Users/joshuaingram/Main/Projects/DCP1/statistical_analysis/author_post_frequency.csv")
frequency <- frequency[-1]
colnames(frequency) <- c("author", "total_posts", "avg_posts_year", "avg_posts_month", "avg_posts_week")
metrics <- read_csv("/Users/joshuaingram/Main/Projects/DCP1/statistical_analysis/Metric.csv")
colnames(metrics) <- c("author", "min_rating", "max_rating", "med_rating", "avg_rating")
tags <- read_csv("/Users/joshuaingram/Main/Projects/DCP1/statistical_analysis/top_words.csv")
tags <- tags[-1,]
colnames(tags) <- c("author", "tag1", "tag2", "tag3")
words <- read_csv("/Users/joshuaingram/Main/Projects/DCP1/statistical_analysis/Words_Auth_Stats.csv")
colnames(words) <- c("author", "min_word_count", "max_word_count", "avg_word_count", "min_paragraph_count", "max_paragraph_count", "avg_paragraph_count")
```

## Merging Data

```{r}
authors <- merge(frequency, metrics, by = "author")
# losing about 100-200 authors here...
authors <- merge(authors, words, by = "author")
authors <- merge(authors, tags, by = "author", all.x = TRUE)
authors$log_avg_rating <- log(authors$avg_rating)
```

```{r}
head(authors)
```

## Exploratory Data Analysis

```{r}
summary(authors)
```


### Metrics

#### Minimum Rating

```{r}
# minimum rating
ggplot(data = authors, aes(x = min_rating)) +
  geom_histogram()
```

```{r}
# log minimum rating
ggplot(data = authors, aes(x = min_rating)) +
  geom_histogram() +
  scale_x_log10()
```

#### Maximum Rating

```{r}
# maximum rating
ggplot(data = authors, aes(x = max_rating)) +
  geom_histogram()
```

```{r}
# log maximum rating
ggplot(data = authors, aes(x = max_rating)) +
  geom_histogram() +
  scale_x_log10()
```

#### Median Rating

```{r}
# median rating
ggplot(data = authors, aes(x = med_rating)) +
  geom_histogram()
```

```{r}
# log median rating
ggplot(data = authors, aes(x = med_rating)) +
  geom_histogram() +
  scale_x_log10()
```

#### Average Rating

```{r}
# average rating
ggplot(data = authors, aes(x = avg_rating)) +
  geom_histogram()
```

```{r}
# log average rating
ggplot(data = authors, aes(x = avg_rating)) +
  geom_histogram() +
  scale_x_log10()
```

### Frequency

#### Weekly Posts

```{r}
# weekly posts
ggplot(data = authors, aes(x = avg_posts_week)) +
  geom_histogram()
```

#### Monthly Posts

```{r}
# monthly posts
ggplot(data = authors, aes(x = avg_posts_month)) +
  geom_histogram()
```

#### Yearly Posts

```{r}
# yearly posts
ggplot(data = authors, aes(x = avg_posts_year)) +
  geom_histogram()
```

#### Total Posts

```{r}
# total posts
ggplot(data = authors, aes(x = total_posts)) +
  geom_histogram()
```

### Words

#### Minimum Paragraph Count

```{r}
# minimum paragraph count
ggplot(data = authors, aes(x = min_paragraph_count)) +
  geom_histogram()
```

#### Maximum Paragraph Count

```{r}
# maximum paragraph count
ggplot(data = authors, aes(x = max_paragraph_count)) +
  geom_histogram()
```

#### Average Paragraph Count

```{r}
# average paragraph count
ggplot(data = authors, aes(x = avg_paragraph_count)) +
  geom_histogram()
```

#### Minimum Word Count

```{r}
# minimum word count
ggplot(data = authors, aes(x = min_word_count)) +
  geom_histogram()
```

```{r}
# log minimum word count
ggplot(data = authors, aes(x = min_word_count)) +
  geom_histogram() +
  scale_x_log10()
```

#### Maximum Word Count

```{r}
# maximum word count
ggplot(data = authors, aes(x = max_word_count)) +
  geom_histogram()
```

```{r}
# log maximum word count
ggplot(data = authors, aes(x = max_word_count)) +
  geom_histogram() +
  scale_x_log10()
```

#### Average Word Count

```{r}
# average word count
ggplot(data = authors, aes(x = avg_word_count)) +
  geom_histogram()
```

```{r}
# log average word count
ggplot(data = authors, aes(x = avg_word_count)) +
  geom_histogram() +
  scale_x_log10()
```

### Tags

#### Tag 1

```{r}
authors %>% group_by(tag1) %>% summarise(avg_rating = mean(avg_rating), count = n())
```

#### Tag 2

```{r}
authors %>% group_by(tag2) %>% summarise(avg_rating = mean(avg_rating), count = n())
```

### Tag 3

```{r}
authors %>% group_by(tag3) %>% summarise(avg_rating = mean(avg_rating), count = n())
```

### Relationships

```{r}
numeric_data <- authors[,sapply(authors, is.numeric)]
cor(numeric_data)
```


## Predicting Author Popularity

```{r}
# perhaps look at the top authors to figure out how the top authors differ
authors_sub <- authors[which(authors$avg_rating > 100),]
authors_sub[is.infinite(authors_sub$log_avg_rating), "log_avg_rating"] <- NA
fit <- lm(log_avg_rating ~ avg_posts_year + avg_word_count + avg_paragraph_count + total_posts, data = authors_sub)
summary(fit)
```


## Summary